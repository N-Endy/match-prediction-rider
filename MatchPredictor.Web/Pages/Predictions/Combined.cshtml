@page
@model MatchPredictor.Web.Pages.Predictions.Combined

@{
    ViewData["Title"] = "Combined Predictions";
    var today = DateTime.UtcNow.ToString("dd MMM yyyy");
    var count = Model.Matches?.Count ?? 0;
}

<div class="mp-container">
    <div class="mp-page-header">
        <div class="mp-page-title">
            <div class="mp-page-title-icon" style="background: rgba(6, 182, 212, 0.1);">ðŸ“Š</div>
            <h1>Combined Predictions</h1>
        </div>
        <div class="mp-date-badge">ðŸ“… @today</div>
    </div>

    @if (count > 0)
    {
        <div class="mp-match-count">
            <span class="mp-live-dot"></span>
            @count match@(count != 1 ? "es" : "") found
        </div>

        <div class="mp-predictions-list">
            @foreach (var match in Model.Matches!)
            {
                var category = match.PredictionCategory ?? "";
                var badgeClass = category switch
                {
                    "BothTeamsScore" => "mp-badge-btts",
                    "Over2.5Goals" => "mp-badge-over",
                    "Draw" => "mp-badge-draw",
                    "StraightWin" => "mp-badge-win",
                    _ => "mp-badge-combined"
                };
                var badgeText = category switch
                {
                    "BothTeamsScore" => "BTTS",
                    "Over2.5Goals" => "Over 2.5",
                    "Draw" => "Draw",
                    "StraightWin" => match.PredictedOutcome ?? "Win",
                    _ => match.PredictedOutcome ?? category
                };
                <div class="mp-prediction-card">
                    <div class="mp-match-info">
                        <div class="mp-match-league">
                            @match.League
                            <span class="mp-time">@match.Time</span>
                        </div>
                        <div class="mp-match-teams">
                            @match.HomeTeam
                            <span class="mp-vs">vs</span>
                            @match.AwayTeam
                        </div>
                    </div>
                    <div class="mp-card-badges">
                        @if (!string.IsNullOrEmpty(match.ActualScore))
                        {
                            var isCorrect = match.PredictedOutcome == match.ActualOutcome;
                            <span class="mp-score @(isCorrect ? "mp-score-correct" : "mp-score-incorrect")">
                                @match.ActualScore
                            </span>
                        }
                        <span class="mp-prediction-badge @badgeClass">@badgeText âœ“</span>
                    </div>
                </div>
            }
        </div>
    }
    else
    {
        <div class="mp-empty-state">
            <div class="mp-empty-state-icon">ðŸ“Š</div>
            <p>No combined predictions available for today yet.</p>
            <p style="font-size: 0.85rem; margin-top: 0.5rem;">Predictions are updated daily. Check back soon!</p>
        </div>
    }
</div>